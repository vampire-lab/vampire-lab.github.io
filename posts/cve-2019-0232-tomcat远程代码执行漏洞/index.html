<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>CVE 2019 0232 Tomcat远程代码执行漏洞 - Vampire blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="CVE 2019 0232 Tomcat远程代码执行漏洞">
<meta itemprop="description" content="漏洞简介 该漏洞只存在于Windows下安装Apache Tomcat 9.0.0.M1 to 9.0.17、Apache Tomcat 8.5.0 to 8.5.39、Apache Tomcat 7.0.0 to 7.0.93 的Tomcat，由于使用enableCmdLineArguments在Windows上运行时，远程执行代码漏洞（CVE-2019-0232）驻留在公共网关接口（CGI）Servlet中，java运行时环境（JRE）将命令行参数传递给Windows的方式存在缺陷导致。但是默认情况下禁用了CGI Servlet，并且在Tomcat 9.0.x中默认情况下禁用了其选项enableCmdLineArguments，因此远程代码执行漏洞被评为中危。
配置环境 要想复现环境需要修改tomcat安装目录中conf目录下的web.xml，内容如下
还需要将servlet-mapping中的注释去掉，内容如下
最后将conf文件夹下的context.xml中context元素添加设置privileged=&quot;true&rdquo;，内容如下
修改完成配置，然后在webapps下创建一个新的文件夹，并且在文件中新建一个WEB-INF文件夹，其中再创建一个cgi-bin目录，将xxx.bat文件写入到cgi-bin目录下，内容如下
上述内容完成后，进入Tomcat的bin目录下，运行startup.bat，访问http://127.0.0.1:8080/
成功，尝试访问我们创建的xxx.bat文件
证明访问成功，文件存在。
漏洞验证 使用poc进行测试 http://127.0.0.1:8080/test/cgi-bin/test.bat?&amp;C%3a%5cwindows%5csystem32%5cipconfig
必须使用URL编码进行访问
返回结果如下
利用成功
也可以使用GitHub上的python脚本进行测试，需要修改url_dir为自己的cgi文件位置。 https://github.com/jas502n/CVE-2019-0232/blob/master/CVE-2019-0232.py">
<meta itemprop="datePublished" content="2019-11-04T16:32:00&#43;08:00" />
<meta itemprop="dateModified" content="2019-11-04T16:32:00&#43;08:00" />
<meta itemprop="wordCount" content="33">



<meta itemprop="keywords" content="漏洞复现," /><meta property="og:title" content="CVE 2019 0232 Tomcat远程代码执行漏洞" />
<meta property="og:description" content="漏洞简介 该漏洞只存在于Windows下安装Apache Tomcat 9.0.0.M1 to 9.0.17、Apache Tomcat 8.5.0 to 8.5.39、Apache Tomcat 7.0.0 to 7.0.93 的Tomcat，由于使用enableCmdLineArguments在Windows上运行时，远程执行代码漏洞（CVE-2019-0232）驻留在公共网关接口（CGI）Servlet中，java运行时环境（JRE）将命令行参数传递给Windows的方式存在缺陷导致。但是默认情况下禁用了CGI Servlet，并且在Tomcat 9.0.x中默认情况下禁用了其选项enableCmdLineArguments，因此远程代码执行漏洞被评为中危。
配置环境 要想复现环境需要修改tomcat安装目录中conf目录下的web.xml，内容如下
还需要将servlet-mapping中的注释去掉，内容如下
最后将conf文件夹下的context.xml中context元素添加设置privileged=&quot;true&rdquo;，内容如下
修改完成配置，然后在webapps下创建一个新的文件夹，并且在文件中新建一个WEB-INF文件夹，其中再创建一个cgi-bin目录，将xxx.bat文件写入到cgi-bin目录下，内容如下
上述内容完成后，进入Tomcat的bin目录下，运行startup.bat，访问http://127.0.0.1:8080/
成功，尝试访问我们创建的xxx.bat文件
证明访问成功，文件存在。
漏洞验证 使用poc进行测试 http://127.0.0.1:8080/test/cgi-bin/test.bat?&amp;C%3a%5cwindows%5csystem32%5cipconfig
必须使用URL编码进行访问
返回结果如下
利用成功
也可以使用GitHub上的python脚本进行测试，需要修改url_dir为自己的cgi文件位置。 https://github.com/jas502n/CVE-2019-0232/blob/master/CVE-2019-0232.py" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vampire-lab.github.io/posts/cve-2019-0232-tomcat%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" />
<meta property="article:published_time" content="2019-11-04T16:32:00+08:00" />
<meta property="article:modified_time" content="2019-11-04T16:32:00+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CVE 2019 0232 Tomcat远程代码执行漏洞"/>
<meta name="twitter:description" content="漏洞简介 该漏洞只存在于Windows下安装Apache Tomcat 9.0.0.M1 to 9.0.17、Apache Tomcat 8.5.0 to 8.5.39、Apache Tomcat 7.0.0 to 7.0.93 的Tomcat，由于使用enableCmdLineArguments在Windows上运行时，远程执行代码漏洞（CVE-2019-0232）驻留在公共网关接口（CGI）Servlet中，java运行时环境（JRE）将命令行参数传递给Windows的方式存在缺陷导致。但是默认情况下禁用了CGI Servlet，并且在Tomcat 9.0.x中默认情况下禁用了其选项enableCmdLineArguments，因此远程代码执行漏洞被评为中危。
配置环境 要想复现环境需要修改tomcat安装目录中conf目录下的web.xml，内容如下
还需要将servlet-mapping中的注释去掉，内容如下
最后将conf文件夹下的context.xml中context元素添加设置privileged=&quot;true&rdquo;，内容如下
修改完成配置，然后在webapps下创建一个新的文件夹，并且在文件中新建一个WEB-INF文件夹，其中再创建一个cgi-bin目录，将xxx.bat文件写入到cgi-bin目录下，内容如下
上述内容完成后，进入Tomcat的bin目录下，运行startup.bat，访问http://127.0.0.1:8080/
成功，尝试访问我们创建的xxx.bat文件
证明访问成功，文件存在。
漏洞验证 使用poc进行测试 http://127.0.0.1:8080/test/cgi-bin/test.bat?&amp;C%3a%5cwindows%5csystem32%5cipconfig
必须使用URL编码进行访问
返回结果如下
利用成功
也可以使用GitHub上的python脚本进行测试，需要修改url_dir为自己的cgi文件位置。 https://github.com/jas502n/CVE-2019-0232/blob/master/CVE-2019-0232.py"/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://vampire-lab.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://vampire-lab.github.io/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://vampire-lab.github.io/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://vampire-lab.github.io/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://vampire-lab.github.io/">
				<img src="/images/im/t.png" alt="Vampire blog" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://vampire-lab.github.io/">Vampire blog</a></h1>
	<div class="site-description"><p>不去想是否能够成功,既然选择了远方,便只顾风雨兼程。</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/vampire-lab" title="Github"><i data-feather="github"></i></a></li><li><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav><span class="scheme-toggle"><a href="#" id="scheme-toggle"></a></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">04</span>
							<span class="rest">Nov 2019</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">CVE 2019 0232 Tomcat远程代码执行漏洞</h1>
				</div>
			</div>
					
			<div class="markdown">
				<h3 id="漏洞简介">漏洞简介</h3>
<p>该漏洞只存在于Windows下安装Apache Tomcat 9.0.0.M1 to 9.0.17、Apache Tomcat 8.5.0 to 8.5.39、Apache Tomcat 7.0.0 to 7.0.93 的Tomcat，由于使用enableCmdLineArguments在Windows上运行时，远程执行代码漏洞（CVE-2019-0232）驻留在公共网关接口（CGI）Servlet中，java运行时环境（JRE）将命令行参数传递给Windows的方式存在缺陷导致。但是默认情况下禁用了CGI Servlet，并且在Tomcat 9.0.x中默认情况下禁用了其选项enableCmdLineArguments，因此远程代码执行漏洞被评为中危。</p>
<h3 id="配置环境">配置环境</h3>
<p>要想复现环境需要修改tomcat安装目录中conf目录下的web.xml，内容如下</p>
<p><img src="/images/2019/CVE-2019-0232/2092001-fcba1850f3de57c0.png" alt="web.xml"></p>
<p>还需要将servlet-mapping中的注释去掉，内容如下</p>
<p><img src="/images/2019/CVE-2019-0232/2092001-c85d7a5936dc6ce5.png" alt="servlet-mapping"></p>
<p>最后将conf文件夹下的context.xml中context元素添加设置privileged=&quot;true&rdquo;，内容如下</p>
<p><img src="/images/2019/CVE-2019-0232/20191104162334.png" alt="context.xml"></p>
<p>修改完成配置，然后在webapps下创建一个新的文件夹，并且在文件中新建一个WEB-INF文件夹，其中再创建一个cgi-bin目录，将xxx.bat文件写入到cgi-bin目录下，内容如下</p>
<p><img src="/images/2019/CVE-2019-0232/2092001-2111a0191743c6bd.png" alt="xxx.bat"></p>
<p>上述内容完成后，进入Tomcat的bin目录下，运行startup.bat，访问http://127.0.0.1:8080/</p>
<p><img src="/images/2019/CVE-2019-0232/2092001-905f868f7a4df9e0.png" alt="tomcat 页面"></p>
<p>成功，尝试访问我们创建的xxx.bat文件</p>
<p><img src="/images/2019/CVE-2019-0232/2092001-07ef5c84be562019.png" alt="访问 bat"></p>
<p>证明访问成功，文件存在。</p>
<h3 id="漏洞验证">漏洞验证</h3>
<p>使用poc进行测试
<a href="http://127.0.0.1:8080/test/cgi-bin/test.bat?&amp;C%3a%5cwindows%5csystem32%5cipconfig">http://127.0.0.1:8080/test/cgi-bin/test.bat?&amp;C%3a%5cwindows%5csystem32%5cipconfig</a></p>
<p>必须使用URL编码进行访问</p>
<p>返回结果如下</p>
<p><img src="/images/2019/CVE-2019-0232/2092001-2df6c9e9d5937198.png" alt="执行结果"></p>
<p>利用成功</p>
<p>也可以使用GitHub上的python脚本进行测试，需要修改url_dir为自己的cgi文件位置。
<a href="https://github.com/jas502n/CVE-2019-0232/blob/master/CVE-2019-0232.py">https://github.com/jas502n/CVE-2019-0232/blob/master/CVE-2019-0232.py</a></p>
<p><img src="/images/2019/CVE-2019-0232/2092001-cd0e4cd20b090414.png" alt="CVE-2019-0232.py"></p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0">漏洞复现</a></li>
							
						</ul>
					
				
			</div>


		</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2019  © Copyright notice |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
